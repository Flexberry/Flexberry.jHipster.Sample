# Брокер сообщений (Шина)

Брокер сообщений это инструмент, который обеспечиват связь между приложениями или отдельными сервисами одного приложения в режиме реального времени.
Брокер также обеспечивает преобразование и гибкую маршрутизацию сообщений. В таких системах выделяется две сущности. 
Продюсер (producer) - источник сообщений и потребитель (consumer) - тот, кто принимает эти сообщения.
Сообщения можно также воспринимать, как события (events). В качестве такого брокера в JHipster используется Apache Kafka.

## Apache Kafka

Apache Kafka — это распределенная система потоковой передачи событий с открытым исходным кодом. Благодаря высокой пропускной способности, масштабируемости и надежности применяется в компаниях, работающих с большими объемами данных. Написана на языках Java и Scala.

!Apache Kafka работает поверх сервиса ZooKeeper. ZooKeeper — это распределенный сервис конфигурирования и синхронизации.

**Возможности**:

- Связь микросервисов - связывает отдельные функциональные модули большой системы. Например можно организовать подписку одних модулей на события других.

- Потоковая передача данных - передает данные и сообщения между системами или отдельными компонентами одной системы, выполняя их преобразование и маршрутизацию.

- Ведение журнала событий - данные о переданных сообщениях или иных событий системы записываются в журнал


Kafka — это распределенная система, состоящая из серверов и клиентов , которые обмениваются данными по высокопроизводительному сетевому протоколу TCP . Его можно развернуть на «голом железе», виртуальных машинах и контейнерах как в локальной, так и в облачной среде.

**Серверы** : Kafka запускается как кластер из одного или нескольких серверов, которые могут охватывать несколько центров обработки данных или облачных регионов. Некоторые из этих серверов образуют уровень хранения, называемый брокерами. На других серверах работает Kafka Connect для непрерывного импорта и экспорта данных в виде потоков событий для интеграции Kafka с вашими существующими системами, такими как реляционные базы данных, а также с другими кластерами Kafka.

**Клиенты** : они позволяют вам писать распределенные приложения и микросервисы, которые считывают, записывают и обрабатывают потоки событий параллельно, в масштабе и отказоустойчивым образом даже в случае сетевых проблем или сбоев машины.

**Администрирование и взаимодействие с системой**:

- Управление из командной строки

- API администратора для управления темами, брокерами и другими объектами Kafka и их проверки.

- Продюсер(producer) API для публикации (записи) потока событий.

- Потребитель (consumer) API для подписки (чтения) на одну или несколько тем и для обработки потока событий.

- API Kafka Streams для реализации приложений и микросервисов потоковой обработки. Он предоставляет функции более высокого уровня для обработки потоков событий, включая преобразования, операции с отслеживанием состояния, такие как агрегирование и объединение, работу с окнами, обработку на основе времени события и многое другое.

- Kafka Connect API. Например, коннектор к реляционной базе данных, такой как PostgreSQL, может фиксировать каждое изменение в наборе таблиц.


**Преимущества**:

- Отказоустойчивость

- Масштабируемость

- Производительность

- OpenSource

- Интегрируемость

**Требования**:

Пакет Java Developer Kit (JDK) версии 8 или аналогичный пакет, например OpenJDK.

**Аналоги**:

Чаще всего Kafka сравнивают с RabbitMQ. Обе системы — брокеры сообщений. Главное отличие в модели доставки: Kafka добавляет сообщение в журнал, и консьюмер сам забирает информацию из топика; брокер RabbitMQ самостоятельно отправляет сообщения получателям — помещает событие в очередь и отслеживает его статус. Apache Kafka больше подходит для сбора и агрегации событий из большого количества источников, логов и метрик.

## Источники

1. [Официальный ресурс](https://kafka.apache.org/)
2. [Раздел на сайте JHipster](https://www.jhipster.tech/using-kafka/)
3. [Статья](https://selectel.ru/blog/apache-kafka/)
4. [Статья](https://blog.skillfactory.ru/glossary/kafka-apache/)